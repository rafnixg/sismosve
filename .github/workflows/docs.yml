name: Documentation CI

on:
  push:
    branches: [ main, develop ]
    paths:
      - '**.md'
      - '**.txt'
      - 'docs/**'
      - 'static/llms.txt'
      - 'static/humans.txt'
  pull_request:
    branches: [ main ]
    paths:
      - '**.md'
      - '**.txt'
      - 'docs/**'
      - 'static/llms.txt'
      - 'static/humans.txt'

jobs:
  validate-docs:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v6

    - name: Validate Markdown files
      run: |
        echo "ğŸ” Validating documentation files..."
        
        # Check for common markdown issues
        find . -name "*.md" -type f | while read file; do
          echo "Checking $file"
          
          # Check for broken internal links (basic check)
          if grep -n "\[.*\](\..*)" "$file" > /dev/null; then
            echo "âœ… Internal links found in $file"
          fi
          
          # Check for proper heading structure
          if grep -n "^#" "$file" > /dev/null; then
            echo "âœ… Headings found in $file"
          fi
          
          # Basic syntax validation
          if [ -s "$file" ]; then
            echo "âœ… $file is not empty"
          else
            echo "âš ï¸ Warning: $file is empty"
          fi
        done
        
        echo "ğŸ“‹ Documentation validation completed"

    - name: Check special files
      run: |
        echo "ğŸ” Checking special documentation files..."
        
        # Check robots.txt if exists
        if [ -f "static/robots.txt" ]; then
          echo "âœ… robots.txt found"
          head -5 static/robots.txt
        fi
        
        # Check humans.txt if exists
        if [ -f "static/humans.txt" ]; then
          echo "âœ… humans.txt found"
          head -5 static/humans.txt
        fi
        
        # Check llms.txt if exists
        if [ -f "static/llms.txt" ]; then
          echo "âœ… llms.txt found"
          head -10 static/llms.txt
        fi
        
        echo "ğŸ“„ Special files check completed"

    - name: Notify documentation update
      run: |
        echo "ğŸ“š Documentation changes detected and validated!"
        echo "This workflow runs only for documentation changes to save CI resources."
        echo "Code changes will trigger the main CI/CD pipeline."